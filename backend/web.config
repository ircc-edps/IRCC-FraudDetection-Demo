<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <system.webServer>
    <handlers>
      <add name="httpPlatformHandler" path="*" verb="*" modules="httpPlatformHandler" resourceType="Unspecified" />
    </handlers>
    <!-- Launch Uvicorn on the dynamic port provided by App Service -->
    <httpPlatform
      processPath="%HOME%\Python310x64\python.exe"
      arguments="-m uvicorn main:app --host 0.0.0.0 --port %HTTP_PLATFORM_PORT%"
      startupTimeLimit="120"
      stdoutLogEnabled="true"
      stdoutLogFile="%HOME%\LogFiles\httpPlatformStdout.log">
      <environmentVariables>
        <!-- Ensure Python can import packages vendored in .python_packages -->
        <add name="PYTHONPATH" value="%HOME%\site\wwwroot\.python_packages" />
      </environmentVariables>
    </httpPlatform>
  </system.webServer>
</configuration>

